---
page_type: sample
products:
- office-365
- office-outlook
- ms-graph
languages:
- swift
extensions:
  contentType: samples
  technologies:
  - Microsoft Graph
  services:
  - Office 365
  - Outlook
  - Groups
  platforms:
  - iOS
  createdDate: 5/26/2016 8:08:35 AM
---
# Пример фрагментов кода Microsoft Graph на Swift для iOS

## Содержание

- [Введение](#introduction)
- [Предварительные требования](#prerequisites)
- [Регистрация и настройка приложения](#register-and-configure-the-app)
- [Сборка и отладка](#build-and-debug)
- [Запуск приложения](#running-the-sample)

## Введение

Этот пример содержит репозиторий фрагментов кода, в которых показано, как использовать пакет SDK Microsoft Graph, чтобы отправлять электронные сообщения, управлять группами и выполнять другие действия с данными Office 365. Для работы с данными, возвращаемыми Microsoft Graph, используется [пакет SDK Microsoft Graph для iOS](https://github.com/microsoftgraph/msgraph-sdk-ios).

Этот репозиторий показывает, как получить доступ к нескольким ресурсам, в том числе Microsoft Azure Active Directory (AD) и API Office 365, совершая HTTP-запросы в API Microsoft Graph в приложении iOS.

Эти фрагменты простые и автономные. Вы можете копировать их в свой код или брать их за основу при изучении пакета SDK Microsoft Graph для iOS.

**Примечание.** Если возможно, используйте этот пример с "нерабочей" или тестовой учетной записью. Если вы используете пример, созданные объекты в почтовом ящике и календаре не всегда очищаются. В настоящее время вам необходимо вручную удалить примеры сообщений и событий календаря. Обратите внимание, что фрагменты кода, которые используются для получения и отправки сообщений, а также получения, создания, обновления и удаления событий, работают не со всеми личными учетными записями. Настоящие операции будут поддерживаться в полном объеме, когда эти учетные записи будут обновлены для работы с конечной точкой проверки подлинности версии 2.

## Необходимые компоненты

Для этого примера требуются приведенные ниже компоненты.

- [Xcode](https://developer.apple.com/xcode/downloads/) версии 10.2.1.
- Установка [CocoaPods](https://guides.cocoapods.org/using/using-cocoapods.html) в качестве диспетчера зависимостей.
- Рабочая или личная учетная запись Майкрософт, например Office 365, outlook.com или hotmail.com. Вы можете [подписаться на план Office 365 для разработчиков](https://aka.ms/devprogramsignup), который включает ресурсы, необходимые для создания приложений Office 365.

## Регистрация и настройка приложения

1. Откройте браузер, перейдите в [Центр администрирования Azure Active Directory](https://aad.portal.azure.com) и войдите с помощью **личной учетной записи** (т. е.  учетной записи Майкрософт) или **рабочей или учебной учетной записи**.

1. Выберите **Azure Active Directory** на панели навигации слева, затем выберите **Регистрация приложения** в разделе **Управление**.

1. Выберите **Новая регистрация**. На странице **Регистрация приложения** задайте необходимые значения следующим образом.

    - Задайте для параметра **Имя** значение `Swift Snippets Sample`.
    - Задайте для параметра **Поддерживаемые типы учетных записей** значение **Учетные записи в любом каталоге организации и личные учетные записи Майкрософт**.
    - В разделе **URI перенаправления** выберите в раскрывающемся списке **Общедоступный клиент (для мобильных и классических приложений)** и задайте значение `msauth.com.microsoft.Graph-iOS-Swift-Snippets://auth`.

1. Нажмите кнопку **Зарегистрировать**. На странице **Пример фрагментов кода на Swift** скопируйте значение **Идентификатор приложения (клиента)** и сохраните его — оно потребуется на следующем шаге.

## Сборка и отладка

1. Клонируйте этот репозиторий

1. Откройте раздел **Терминал** и перейдите к корневой папке проекта. Чтобы установить зависимости, выполните указанную ниже команду.

    ```Shell
    pod install
    ```

1. Откройте **Graph-iOS-Swift-Snippets.xcworkspace** в Xcode.

1. Откройте файл **ApplicationConstants.swift**. Замените `ENTER_CLIENT_ID` на идентификатор приложения, полученный при регистрации приложения.

    ```swift
    // You will set your application's clientId
    static let clientId = "ENTER_CLIENT_ID"
    ```

1. Запустите пример.

## Запуск приложения

Когда вы запустите приложение, в нем появится список типичных задач. Доступные задачи будут зависеть от типа учетной записи и уровня разрешений и отражены в примечаниях:

- Задачи, доступные для рабочих, учебных и личных учетных записей, например получение и отправка электронной почты, создание файлов и т. д.
- Задачи, доступные только для рабочих или учебных учетных записей, например получение фотографии учетной записи или сведений о руководителе пользователя.
- Задачи, доступные только для рабочей или учебной учетной записи с административными разрешениями, например получение сведений о членах группы или создание учетных записей пользователей.

Выберите задачу, которую необходимо выполнить, и щелчком запустите ее. Обратите внимание, что при входе в систему с помощью учетной записи, не имеющей соответствующих разрешений для выбранных задач, последние невозможно выполнить. Например, если вы попытаетесь выполнить определенный фрагмент кода (например, получить все клиентские группы) из учетной записи без прав администратора в организации, операция завершится ошибкой. Если вы войдете в систему с помощью личной учетной записи, вам не удастся получить сведения о руководителе пользователя, который вошел в систему.

## Участие

Если вы хотите добавить код в этот пример, просмотрите статью [CONTRIBUTING.MD](/CONTRIBUTING.md).

Этот проект соответствует [правилам поведения Майкрософт, касающимся обращения с открытым кодом](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [Часто задаваемые вопросы о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).

## Авторское право

(c) Корпорация Майкрософт (Microsoft Corporation), 2016. Все права защищены.
